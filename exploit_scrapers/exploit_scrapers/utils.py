from open_exploit_database_scraping.exploit.models import Exploit
from django.core.files.base import ContentFile

def save_exploit(source, name, is_repo, date_published=None, author=None, description=None, file_name=None, file_content=None):
    """Function takes in the parameters needed to create and save an exploit mode. Will not save duplicates."""
    exploit, is_created = Exploit.objects.get_or_create(
        source=source, name=name, date_published=date_published, author=author, description=description, is_repo=is_repo
        )
    if is_created:
        # If we created a new model ...
        if file_name is not None:
            # If we have a file to save, save it
            exploit.example_file.save(file_name, ContentFile(file_content))
        # Save model.
        exploit.save()