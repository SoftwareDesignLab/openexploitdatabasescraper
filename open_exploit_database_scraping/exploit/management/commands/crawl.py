from django.core.management.base import BaseCommand
from scrapy.crawler import CrawlerProcess

# Import our spiders from our scrapy project.
from exploit_scrapers.exploit_scrapers.spiders import cxsecurity_spider, exploit_db_csv_spider, readme_spider, packetstorm_spider

class Command(BaseCommand):
    help = 'Runs the CXSecurity Spider.'

    def handle(self, *args, **kwargs):
        # Test scrape CXSecurity.
        process = CrawlerProcess()
        #process.crawl(cxsecurity_spider.CXSecuritySpider)
        # Test scrape Exploit DB
        #process.crawl(exploit_db_csv_spider.CSVSpider)
        process.crawl(packetstorm_spider.PacketStormSpider)
        # Start the crawlers.
        process.start()
        process.stop()
        self.stdout.write("\n[DEBUG] Crawling done.")