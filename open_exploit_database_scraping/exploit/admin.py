from django.contrib import admin
from .models import Exploit
# Register your models here.

@admin.action(description="Mark selected exploits as resolved")
def resolved(modeladmin, request, queryset):
    queryset.update(download_failed=False)
    queryset.update(fixed=True)

@admin.action(description="Ignore selected entries")
def ignore(modeladmin, request, queryset):
    queryset.update(ignore=True)

class ExploitAdmin(admin.ModelAdmin):
    list_display = [
        "name",
        "source",
        "date_published",
        "date_created",
    ]
    list_filter = ("download_failed", "ignore", "fixed", )
    search_fields = ["name", "source"]
    actions = [resolved, ignore]

admin.site.register(Exploit, ExploitAdmin)