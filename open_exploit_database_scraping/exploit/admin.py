from django.contrib import admin
from .models import Exploit
# Register your models here.

@admin.action(description="Mark selected exploits as resolved")
def resolved(modeladmin, request, queryset):
    queryset.update(download_failed=False)

class ExploitAdmin(admin.ModelAdmin):
    list_display = [
        "name",
        "source",
        "date_published",
        "date_created",
    ]
    list_filter = ("download_failed", )
    search_fields = ["name", "source"]
    actions = [resolved]

admin.site.register(Exploit, ExploitAdmin)